<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    body {
      font-family: Arial, sans-serif;
      font-size: 11px;
      color: #000;
    }

    .pass {
      border: 1px solid #000;
      padding: 18px;
      min-height: 360px;
    }

    .divider {
      border-top: 2px dashed #000;
      margin: 28px 0;
    }

    .header {
      text-align: center;
      margin-bottom: 16px;
    }

    .company-name {
      font-size: 17px;
      font-weight: bold;
      letter-spacing: 0.5px;
    }

    .subtitle {
      font-size: 11px;
      margin-top: 4px;
      color: #444;
    }

    .title {
      margin-top: 10px;
      font-size: 14px;
      font-weight: bold;
      text-decoration: underline;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 14px;
    }

    td, th {
      border: 1px solid #000;
      padding: 7px;
      vertical-align: top;
    }

    th {
      background: #f2f2f2;
      font-weight: bold;
      text-align: left;
    }

    .label {
      width: 30%;
      font-weight: bold;
      background: #fafafa;
    }

    .value {
      width: 20%;
    }

    .right {
      text-align: right;
    }

    .price-row td {
      font-weight: bold;
    }

    .total-row td {
      font-weight: bold;
      font-size: 12px;
      background: #f9f9f9;
    }

    .signature {
      margin-top: 55px;
      text-align: right;
    }

    .signature-line {
      width: 220px;
      border-top: 1px solid #000;
      margin-left: auto;
      margin-bottom: 4px;
    }

    .footer {
      margin-top: 26px;
      font-size: 9.5px;
      color: #444;
      text-align: center;
    }
  </style>
</head>

<body>

{% for copy in "12" %}
<div class="pass">

  <div class="header">
    <div class="company-name">{{ company }}</div>
    <div class="title">PURCHASE ORDER</div>
  </div>

  <table>
    <tr>
      <td class="label">PO Number</td>
      <td class="value">{{ order.id|stringformat:"s"|slice:":8" }}</td>
      <td class="label">PO Date</td>
      <td class="value">{{ order.created_at|date:"d.m.Y" }}</td>
    </tr>

    <tr>
      <td class="label">Product</td>
      <td colspan="3">{{ order.product.name }}</td>
    </tr>

    <tr>
      <td class="label">Warehouse</td>
      <td colspan="3">{{ order.warehouse.name }}</td>
    </tr>

    <tr>
      <td class="label">Quantity</td>
      <td>{{ order.delta }}</td>
      <td class="label">Status</td>
      <td>{{ order.status }}</td>
    </tr>

    <tr class="price-row">
      <td class="label">Unit Price</td>
      <td class="right">₹ {{ order.product.price|floatformat:2 }}</td>
      <td class="label">Total Amount</td>
      <td class="right">₹ {{ total_price|floatformat:2 }}</td>
    </tr>

    <tr>
      <td class="label">Reason</td>
      <td colspan="3">{{ order.reason }}</td>
    </tr>

    <tr>
      <td class="label">Approved By</td>
      <td>{{ order.approved_by.get_full_name|default:order.approved_by.username }}</td>
      <td class="label">Approved At</td>
      <td>{{ order.approved_at|date:"d.m.Y H:i" }}</td>
    </tr>
  </table>

  <div class="signature">
    <div class="signature-line"></div>
    <div>Authorised Signature</div>
  </div>

  <div class="footer">
    Generated on {{ generated_at|date:"d.m.Y H:i" }}<br/>
    This document authorizes inventory movement.
  </div>

</div>

{% if not forloop.last %}
  <div class="divider"></div>
{% endif %}
{% endfor %}

</body>
</html>

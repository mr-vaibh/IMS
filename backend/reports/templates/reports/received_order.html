<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Goods Receipt Note - GRN {{ order.id }}</title>
  <style>
    body {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 12px;
      color: #333;
      margin: 0;
      padding: 20px;
    }

    h2 {
      text-align: center;
      margin-bottom: 10px;
    }

    .sub-title {
      text-align: center;
      font-size: 11px;
      margin-bottom: 20px;
    }

    p {
      margin: 4px 0;
    }

    strong {
      width: 140px;
      display: inline-block;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    table th, table td {
      border: 1px solid #aaa;
      padding: 8px;
    }

    table th {
      background-color: #f2f2f2;
      text-align: left;
    }

    .text-right {
      text-align: right;
    }

    .header-grid {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .box {
      width: 48%;
      border: 1px solid #aaa;
      padding: 10px;
    }

    .signature {
      display: flex;
      justify-content: space-between;
      border-top: 1px solid #000;
      padding-top: 20px;
    }
    </style>

    {% if not order.reason %}
    <style>
      .signature {
        margin-top: 50px;
      }
      </style>
    {% endif %}

</head>
<body>
  <h2>GOODS RECEIPT NOTE (GRN)</h2>
  <div class="sub-title">Stock In / Material Receipt Document</div>

  <div class="header-grid">
    <div class="box">
      <p><strong>GRN No:</strong><br> GRN-{{ order.id }}</p>
      <p><strong>GRN Date:</strong> {{ order.received_at|date:"d M Y, H:i" }}</p>
      <p><strong>Warehouse:</strong> {{ warehouse.name }}</p>
    </div>

    <div class="box">
      <p><strong>PO / Order ID:</strong><br> {{ order.id }}</p>
      <p><strong>Requested By:</strong> {{ order.requested_by.username }}</p>
      <p><strong>Approved By:</strong>
        {% if order.approved_by %}
          {{ order.approved_by.username }}
        {% else %}
          —
        {% endif %}
      </p>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Item Description</th>
        <th>SKU</th>
        <th class="text-right">Qty Received</th>
        <th>Unit</th>
        <th class="text-right">Rate</th>
        <th class="text-right">Total Amount</th>
      </tr>
    </thead>
    <tbody>
      {% for item in items %}
      <tr>
        <td>{{ item.name }}</td>
        <td>{{ item.sku }}</td>
        <td class="text-right">{{ item.qty }}</td>
        <td>{{ item.unit }}</td>
        <td class="text-right">₹{{ item.rate }}</td>
        <td class="text-right">₹{{ item.amount }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% if order.reason %}
    <div style="margin-top: 20px; border-top: 1px solid #000; padding: 10px;">
      <p><strong>Reason / Remarks:</strong></p>
      <p>{{ order.reason }}</p>
    </div>
  {% endif %}
  
  <div class="signature">
    <div>
      <strong>Received & Verified By (Store / QC)</strong><br><br>
      {% if order.received_by %}
        {{ order.received_by.username }}<br>
        Date: {{ order.received_at|date:"d M Y, H:i" }}
      {% else %}
        —
      {% endif %}
    </div>

    <div style="text-align:right; max-width:300px;">
      <strong>Authorised Signatory</strong><br><br>
      {% if signature.signed_by %}
        {{ signature.signed_by }}<br>
      {% endif %}
      {% if signature.company %}
        {{ signature.company }}<br>
      {% endif %}
      {% if signature.role %}
        {{ signature.role }}<br>
      {% endif %}
      {% if signature.signed_at %}
        Signed on: {{ signature.signed_at|date:"d M Y, H:i" }}
      {% endif %}
    </div>
  </div>

  <p style="text-align:center; margin-top:20px;">
    <em>This is a system-generated Goods Receipt Note (GRN).</em>
  </p>

</body>
</html>
